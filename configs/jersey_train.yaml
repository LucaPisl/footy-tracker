# Jersey number classifier training config.
data:
  root: "data/sn_jersey/jersey-2023"
  train_split: "train"
  auto_extract: true
  include_unknown: false
  unknown_label: "unknown"
  val_ratio: 0.1
  max_frames_per_track: 30
  seed: 1337

model:
  arch: "resnet34"
  pretrained: true
  image_size: 224

augment:
  use_random_resized_crop: false
  scale_min: 0.85
  scale_max: 1.0
  color_jitter: 0.2
  random_erasing_prob: 0.0

train:
  epochs: 80
  batch_size: 128
  lr: 0.0003
  weight_decay: 0.00005
  num_workers: 4
  device: "auto"
  use_class_weights: true
  output_dir: "outputs/train/jersey"
  checkpoint_every: 1
  label_smoothing: 0.0
  loss:
    type: "cross_entropy"
    focal_gamma: 2.0
  mixup_cutmix:
    mixup_prob: 0.0
    mixup_alpha: 0.0
    cutmix_prob: 0.0
    cutmix_alpha: 0.0
  early_stopping:
    enabled: true
    patience: 10
    min_delta: 0.002
    metric: "val_acc"
    mode: "max"
  resume:
    enabled: false
    checkpoint_path: "outputs/train/jersey/checkpoint_last.pt"
  scheduler:
    name: "cosine"
